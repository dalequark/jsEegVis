var coreAudio = require("./node-core-audio");
 
var engine = coreAudio.createNewAudioEngine();
 
var numDevices = engine.getNumDevices();
 
var inputDeviceId;
var outputDeviceId;
for (var i = 0; i < numDevices; i++) {
    var name = engine.getDeviceName(i);
    if( !inputDeviceId && /Line in/.test(name) ) {
        inputDeviceId = i;
    }
    if( !outputDeviceId && /Haut-parleurs/.test(name) ) {
        outputDeviceId = i;
    }
}
 
var options = {
    inputChannels: 1,
    outputChannels: 2,
//    inputDevice: 6,
//    outputDevice: 3,
};
 
engine.setOptions( options );

console.log( engine.getOptions() );
 
engine.addAudioCallback( function( inputBuffer ) {
    var outputBuffer = [];

    outputBuffer[0] = [];
//    outputBuffer[1] = [];

    for( var iSample in inputBuffer[0] ) {
        outputBuffer[0][iSample] = iSample / inputBuffer[0].length;
//        outputBuffer[1][iSample] = 1 - iSample / inputBuffer.length;

    }

//    console.log( outputBuffer.length + " channels" );
//    for( iChannel in outputBuffer )
//        console.log( outputBuffer[iChannel].length + " samples" );

    return outputBuffer;
});